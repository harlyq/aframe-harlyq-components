<!DOCTYPE html>
<html>
  <head>
    <title>Heightfield examples</title>
    <script src="https://aframe.io/releases/0.9.2/aframe.js"></script>
    <!--script src="../../aframe/aframe-0.9.2.js"></script-->
    <script src="../dist/aframe-harlyq-components.js"></script>
    <script id="thingshader" type="x-shader/x-fragment">
      #include <procedural-ext>
      uniform float multiplier;
      uniform float offset;
      varying vec2 vUv;
      void main() {
        float v = fbm(vUv*multiplier + offset)*(1. - smoothstep(.2, .5, length(vUv - .5)));
        gl_FragColor = vec4(mix(vec3(0.), vec3(1.), v), 1.);
      }
    </script>
    <script id="rampshader" type="x-shader/x-fragment">
      precision highp float;
      varying vec2 vUv;
      void main() {
        float v = smoothstep(.4, .9, length(vUv));
        gl_FragColor = vec4(mix(vec3(0.), vec3(0.,1.,0.), v), 1.);
      }
    </script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <canvas id="thing" width="64" height="64">
        <canvas id="ramp" width="64" height="64">
      </a-assets>
      <a-entity id="island"
        procedural-texture__thing="shader: #thingshader; canvas: #thing; multiplier: 3; offset: .1"
        heightfield="src: #thing; channels: r; numRows: 32; numCols: 32; heightScale: .4; smooth: false" material="color: white; side: double;" position="0 1 -2"
        face-color__ground="color: brown"
        face-color__snow="color: grey; maxSlope: 70; minPosition: 0 .3 0"
        face-color__tree="color: green; maxPosition: 1 .1 1; maxSlope: 40"
        face-color__sea="color: blue; maxPosition: 1 0 1"></a-entity>
      <a-box material="src: #thing; color: grey;" scale=".1 .1 .1" position="0 1 -1"></a-box>

      <a-entity id="smoothIsland"
        position="1.5 1 -2"
        procedural-texture__thing="shader: #thingshader; canvas: #thing; multiplier: 3; offset: .1"
        heightfield="src: #thing; channels: r; numRows: 32; numCols: 32; heightScale: .4; smooth: true" material="color: white; side: double;" position="0 1 -2"
        vertex-color__ground="color: brown"
        vertex-color__snow="color: grey; maxSlope: 70; minPosition: 0 .3 0"
        vertex-color__tree="color: green; maxPosition: 1 .1 1; maxSlope: 40"
        vertex-color__sea="color: blue; maxPosition: 1 0 1"></a-entity>
      <a-box material="src: #thing; color: grey;" scale=".1 .1 .1" position="1.5 1 -1"></a-box>

      <a-entity id="test"
        procedural-texture__ramp="shader: #rampshader; canvas: #ramp;"
        heightfield="src: #ramp; channels: g; numRows: 32; numCols: 32; smooth: true"
        material="wireframe: true; side: double; src: #ramp"
        position="-1.5 1 -2"></a-entity>
      <a-box material="src: #ramp;" scale=".1 .1 .1" position="-1.5 1 -1"></a-box>

      <a-box id="facecolor" position="2 2 -2" scale=".1 .1 .1" face-color__0="faces: 0,1; color: red" face-color__2="faces: 2,3; color: blue" face-color__4="faces: 4,5; color: yellow" face-color__6="faces: 6,7; color: magenta" face-color__8="faces: 8,9; color: cyan"></a-box-->
    </a-scene>
  </body>
</html>